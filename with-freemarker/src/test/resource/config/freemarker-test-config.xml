<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 6.0//EN"
        "aspectran-6-test.dtd">
<aspectran>

    <description>
        This is an Aspectran Configuration for Testing.
    </description>

    <settings>
        <setting name="defaultTemplateEngineBean" value="freemarker"/>
    </settings>

    <bean id="freemarkerConfigurationFactory" class="com.aspectran.freemarker.FreeMarkerConfigurationFactoryBean">
        <properties>
            <item name="freemarkerSettings" type="properties">
                <value name="incompatible_improvements">2.3.23</value>
                <value name="template_exception_handler">rethrow</value>
                <value name="default_encoding">UTF-8</value>
                <value name="number_format">0.####</value>
            </item>
            <item name="trimDirectives" valueType="parameters">
                directive: {
                    name: "trim"
                }
                directive: {
                    name: "where"
                    prefix: "WHERE "
                    deprefixes: [
                        "and"
                        "or"
                    ]
                }
                directive: {
                    name: "set"
                    prefix: "SET "
                    desuffixes: ","
                }
            </item>
        </properties>
    </bean>

    <bean id="freemarker" class="com.aspectran.freemarker.FreeMarkerTemplateEngine">
        <constructor>
            <arguments>
                <item><call bean="freemarkerConfigurationFactory"/></item>
            </arguments>
        </constructor>
    </bean>

    <translet name="free">
        <description>
            두 개의 입력 값과 Freemarker 템플릿 엔진을 사용해서 텍스트 형식으로 출력합니다.
        </description>
        <request>
            <parameters>
                <item name="input_1">${input_1:12345}</item>
                <item name="input_2">${input_2:67890}</item>
            </parameters>
        </request>
        <transform type="transform/text">
            <template engine="freemarker" style="apon">
                |Using Freemarker Template Engine
                |-------------------------------------
                |input_1: ${input_1}
                |input_2: ${input_2}
            </template>
        </transform>
    </translet>

    <template id="sampleSql" engine="freemarker" style="apon">
        <![CDATA[
        |SELECT
        |    '${name}' as name,
        |    '${email}' as email
        |FROM table1
        |<@directive.where>
        |    <#if id?has_content>
        |    id = :id
        |    </#if>
        |    <#if name?has_content>
        |    AND name = :name
        |    </#if>
        |    <#if email?has_content>
        |    AND email = :email
        |    </#if>
        |</@directive.where>
        |ORDER BY name
        |---------------------------------------------
        |UPDATE table1
        |<@directive.set>
        |    <#if name??>
        |    name = :name,
        |    </#if>
        |    <#if email??>
        |    email = :email,
        |    </#if>
        |    <#if id??>
        |    id = :id
        |    </#if>
        |</@directive.set>
        ]]>
    </template>

    <translet name="sql">
        <description>
            Freemarker 템플릿 엔진을 사용해서 간단한 SQL문을 생성하는 예제입니다.
        </description>
        <request>
            <attributes>
                <item name="name">${name:Jane}</item>
                <item name="email">${email:jane@mail.com}</item>
            </attributes>
        </request>
        <transform type="transform/text">
            <call template="sampleSql"/>
        </transform>
    </translet>

</aspectran>