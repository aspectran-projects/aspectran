<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 3.0//EN"
		"http://aspectran.github.io/dtd/aspectran-3.dtd">

<aspectran>

	<settings>
		<setting name="transletNamePattern" value="*.job"/>
	</settings>

	<bean id="*" scan="test.**.*Schedule" mask="test.**.*"/>

	<bean id="defaultScheduler1" class="com.aspectran.scheduler.support.QuartzSchedulerFactoryBean">
		<properties>
			<item type="properties" name="props">
				<value name="org.quartz.scheduler.instanceName">AspectranQuartzScheduler-1</value>
				<value name="org.quartz.scheduler.rmi.export">false</value>
				<value name="org.quartz.scheduler.rmi.proxy">false</value>
				<value name="org.quartz.scheduler.wrapJobExecutionInUserTransaction">false</value>
				<value name="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</value>
				<value name="org.quartz.threadPool.threadCount">10</value>
				<value name="org.quartz.threadPool.threadPriority">5</value>
				<value name="org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread">true</value>
				<value name="org.quartz.jobStore.misfireThreshold">60000</value>
				<value name="org.quartz.jobStore.class">org.quartz.simpl.RAMJobStore</value>
			</item>
		</properties>
	</bean>

	<bean id="schedulerFactory" class="org.quartz.impl.StdSchedulerFactory">
		<constructor>
			<arguments>
				<item type="properties">
					<value name="org.quartz.scheduler.instanceName">AspectranQuartzScheduler-2</value>
					<value name="org.quartz.scheduler.rmi.export">false</value>
					<value name="org.quartz.scheduler.rmi.proxy">false</value>
					<value name="org.quartz.scheduler.wrapJobExecutionInUserTransaction">false</value>
					<value name="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</value>
					<value name="org.quartz.threadPool.threadCount">10</value>
					<value name="org.quartz.threadPool.threadPriority">5</value>
					<value name="org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread">true</value>
					<value name="org.quartz.jobStore.misfireThreshold">60000</value>
					<value name="org.quartz.jobStore.class">org.quartz.simpl.RAMJobStore</value>
				</item>
			</arguments>
		</constructor>
	</bean>

	<bean id="defaultScheduler2" offerBean="schedulerFactory" offerMethod="getScheduler"/>

	<schedule id="scheduler1">
		<trigger type="simple">
			intervalInSeconds: 3
			repeatCount: 10
		</trigger>
		<scheduler bean="defaultScheduler1">
			<job translet="job1"/>
		</scheduler>
	</schedule>

	<schedule id="scheduler2">
		<trigger type="simple">
			startDelaySeconds: 2
			intervalInSeconds: 1
			repeatCount: 10
		</trigger>
		<scheduler bean="defaultScheduler2">
			<job translet="job2"/>
		</scheduler>
	</schedule>

	<translet name="job1">
		<action bean="class:test.ScheduleAction" method="delay">
			<arguments>
				<item valueType="long">1</item>
			</arguments>
		</action>
		<transform type="transform/text" contentType="text/plain">
			<template>(1) Hello, World!</template>
		</transform>
	</translet>

	<translet name="job2">
		<action bean="class:test.ScheduleAction" method="delay">
			<arguments>
				<item valueType="long">2</item>
			</arguments>
		</action>
		<transform type="transform/text" contentType="text/plain">
			<template>(2) Hello, World!</template>
		</transform>
	</translet>

</aspectran>